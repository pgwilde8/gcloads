<div class="call-panel bg-slate-900/80 border border-slate-800 rounded-2xl p-6 mt-4" id="call-panel-{{ load_ref }}" style="display:none;">
    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
        <i class="fas fa-phone text-green-400"></i>
        Call Broker
    </h3>
    <div class="mb-4">
        <div class="flex items-center gap-2">
            <span class="text-lg font-bold text-green-400" id="call-phone-{{ load_ref }}">{{ broker_phone }}</span>
            <button onclick="copyText('call-phone-{{ load_ref }}')" class="bg-green-700 hover:bg-green-600 text-white px-3 py-1 rounded text-xs">Copy</button>
        </div>
    </div>
    <div class="mb-4">
        <div class="flex items-center gap-2">
            <span class="text-sm text-slate-300" id="call-script-{{ load_ref }}">
                Hi, this is {{ driver_name or carrier_name }} calling about load {{ load_ref }} from {{ origin }} to {{ destination }}. Is it still available?
            </span>
            <button onclick="copyText('call-script-{{ load_ref }}')" class="bg-green-700 hover:bg-green-600 text-white px-3 py-1 rounded text-xs">Copy</button>
        </div>
    </div>
    <form hx-post="/api/call-log" hx-target="#call-log-status-{{ load_ref }}" hx-swap="innerHTML" class="space-y-3">
        <input type="hidden" name="load_ref" value="{{ load_ref }}">
        <input type="hidden" name="broker_id" value="{{ broker_id }}">
        <input type="hidden" name="negotiation_id" value="{{ negotiation_id }}">
        <input type="hidden" name="phone" value="{{ broker_phone }}">
        <div>
            <label class="block text-xs text-slate-400 mb-1 font-bold uppercase">Outcome</label>
            <select name="outcome" required class="w-full rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 text-sm">
                <option value="LEFT_VM">Left Voicemail</option>
                <option value="SPOKE">Spoke</option>
                <option value="WON">Won</option>
                <option value="LOST">Lost</option>
                <option value="CALLBACK">Callback Needed</option>
            </select>
        </div>
        <div>
            <label class="block text-xs text-slate-400 mb-1 font-bold uppercase">Rate (optional)</label>
            <input type="number" step="0.01" name="rate" class="w-full rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 text-sm">
        </div>
        <div>
            <label class="block text-xs text-slate-400 mb-1 font-bold uppercase">Notes (optional)</label>
            <textarea name="notes" class="w-full rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 text-sm"></textarea>
        </div>
        <div>
            <label class="block text-xs text-slate-400 mb-1 font-bold uppercase">Next Follow-Up (optional)</label>
            <input type="datetime-local" name="next_follow_up_at" class="w-full rounded-lg bg-slate-800 border border-slate-700 text-white px-4 py-2 text-sm">
        </div>
        <button type="submit" class="bg-green-600 hover:bg-green-500 text-white font-bold px-6 py-2 rounded-lg transition">Log Call</button>
        <div id="call-log-status-{{ load_ref }}" class="mt-2"></div>
    </form>
</div>
